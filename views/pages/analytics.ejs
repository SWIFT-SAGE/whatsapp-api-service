<!-- Analytics Section -->
<div id="dashboard-analytics" class="dashboard-section">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2>Advanced Analytics</h2>
        <div class="d-flex gap-2">
            <div class="btn-group" id="period-selector">
                <button class="btn btn-outline-secondary" data-period="7d">7 Days</button>
                <button class="btn btn-outline-secondary active" data-period="30d">30 Days</button>
                <button class="btn btn-outline-secondary" data-period="90d">90 Days</button>
            </div>
            <button class="btn btn-outline-primary" id="refresh-analytics-btn">
                <i class="fas fa-sync-alt me-2"></i>Refresh
            </button>
            <button class="btn btn-success" id="export-analytics-btn">
                <i class="fas fa-download me-2"></i>Export
            </button>
        </div>
    </div>

    <!-- Key Metrics -->
    <div class="row g-4 mb-4" id="analytics-metrics">
        <div class="col-lg-3 col-md-6">
            <div class="card text-center">
                <div class="card-body">
                    <div class="display-6 text-primary mb-2" id="delivery-rate">
                        <div class="spinner-border spinner-border-sm" role="status"></div>
                    </div>
                    <h6>Delivery Rate</h6>
                    <small class="text-muted" id="delivery-rate-change">Loading...</small>
                </div>
            </div>
        </div>
        <div class="col-lg-3 col-md-6">
            <div class="card text-center">
                <div class="card-body">
                    <div class="display-6 text-success mb-2" id="total-messages">
                        <div class="spinner-border spinner-border-sm" role="status"></div>
                    </div>
                    <h6>Total Messages</h6>
                    <small class="text-muted" id="total-messages-change">Loading...</small>
                </div>
            </div>
        </div>
        <div class="col-lg-3 col-md-6">
            <div class="card text-center">
                <div class="card-body">
                    <div class="display-6 text-warning mb-2" id="active-sessions">
                        <div class="spinner-border spinner-border-sm" role="status"></div>
                    </div>
                    <h6>Active Sessions</h6>
                    <small class="text-muted" id="active-sessions-change">Loading...</small>
                </div>
            </div>
        </div>
        <div class="col-lg-3 col-md-6">
            <div class="card text-center">
                <div class="card-body">
                    <div class="display-6 text-info mb-2" id="message-types">
                        <div class="spinner-border spinner-border-sm" role="status"></div>
                    </div>
                    <h6>Message Types</h6>
                    <small class="text-muted" id="message-types-change">Loading...</small>
                </div>
            </div>
        </div>
    </div>

    <!-- Charts -->
    <div class="row g-4">
        <div class="col-lg-8">
            <div class="card">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <h5>Message Volume Trends</h5>
                    <div class="btn-group btn-group-sm">
                        <button class="btn btn-outline-secondary active" data-chart-period="7d">7D</button>
                        <button class="btn btn-outline-secondary" data-chart-period="30d">30D</button>
                    </div>
                </div>
                <div class="card-body">
                    <div id="volume-chart-loading" class="text-center py-5">
                        <div class="spinner-border text-primary mb-3" role="status"></div>
                        <p class="text-muted">Loading chart data...</p>
                    </div>
                    <canvas id="volumeChart" height="100" style="display: none;"></canvas>
                    <div id="volume-chart-error" class="text-center py-5 text-danger" style="display: none;">
                        <i class="fas fa-exclamation-triangle fa-2x mb-3"></i>
                        <p>Failed to load chart data</p>
                        <button class="btn btn-outline-primary btn-sm" onclick="loadVolumeChart()">Retry</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-lg-4">
            <div class="card">
                <div class="card-header">
                    <h5>Message Status Distribution</h5>
                </div>
                <div class="card-body">
                    <div id="status-chart-loading" class="text-center py-4">
                        <div class="spinner-border text-primary mb-3" role="status"></div>
                        <p class="text-muted">Loading...</p>
                    </div>
                    <canvas id="statusChart" height="200" style="display: none;"></canvas>
                    <div id="status-chart-error" class="text-center py-4 text-danger" style="display: none;">
                        <i class="fas fa-exclamation-triangle mb-2"></i>
                        <p>Failed to load data</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Additional Analytics -->
    <div class="row g-4 mt-2">
        <div class="col-lg-6">
            <div class="card">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <h5>Top Contacts</h5>
                    <button class="btn btn-outline-primary btn-sm" id="view-all-contacts-btn">
                        View All
                    </button>
                </div>
                <div class="card-body">
                    <div id="top-contacts-loading" class="text-center py-4">
                        <div class="spinner-border text-primary mb-3" role="status"></div>
                        <p class="text-muted">Loading contacts...</p>
                    </div>
                    <div id="top-contacts-list" style="display: none;">
                        <!-- Contacts will be populated dynamically -->
                    </div>
                    <div id="top-contacts-empty" class="text-center py-4 text-muted" style="display: none;">
                        <i class="fas fa-users fa-2x mb-3 opacity-50"></i>
                        <p>No contact data available</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-lg-6">
            <div class="card">
                <div class="card-header">
                    <h5>Session Analytics</h5>
                </div>
                <div class="card-body">
                    <div id="session-analytics-loading" class="text-center py-4">
                        <div class="spinner-border text-primary mb-3" role="status"></div>
                        <p class="text-muted">Loading sessions...</p>
                    </div>
                    <div id="session-analytics-content" style="display: none;">
                        <!-- Session analytics will be populated dynamically -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Message Types Breakdown -->
    <div class="row g-4 mt-2">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h5>Message Types Breakdown</h5>
                </div>
                <div class="card-body">
                    <div id="message-types-loading" class="text-center py-4">
                        <div class="spinner-border text-primary mb-3" role="status"></div>
                        <p class="text-muted">Loading message types...</p>
                    </div>
                    <div id="message-types-content" style="display: none;">
                        <div class="row" id="message-types-cards">
                            <!-- Message type cards will be populated dynamically -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
