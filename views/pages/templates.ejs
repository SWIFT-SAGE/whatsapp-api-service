<!-- Templates Section -->
<div id="dashboard-templates" class="dashboard-section">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2><i class="fas fa-file-alt me-2"></i>Message Templates</h2>
        <button class="btn btn-primary" id="create-template-btn">
            <i class="fas fa-plus me-2"></i>New Template
        </button>
    </div>

    <!-- Template Categories Tabs -->
    <ul class="nav nav-tabs mb-4" id="templateTabs" role="tablist">
        <li class="nav-item" role="presentation">
            <button class="nav-link active" id="all-tab" data-template-category="all" type="button">
                <i class="fas fa-layer-group me-1"></i>All Templates
            </button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="marketing-tab" data-template-category="marketing" type="button">
                <i class="fas fa-bullhorn me-1"></i>Marketing
            </button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="otp-tab" data-template-category="otp" type="button">
                <i class="fas fa-lock me-1"></i>OTP
            </button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="custom-tab" data-template-category="custom" type="button">
                <i class="fas fa-edit me-1"></i>Custom
            </button>
        </li>
    </ul>

    <!-- Templates Content -->
    <div class="tab-content" id="templateTabContent">
        <!-- All Templates Tab -->
        <div class="tab-pane fade show active" id="all-templates" role="tabpanel">
            <div class="row g-4" id="all-templates-container">
                <div class="col-12 text-center py-5">
                    <div class="spinner-border text-primary" role="status">
                        <span class="visually-hidden">Loading...</span>
                    </div>
                    <p class="text-muted mt-2">Loading templates...</p>
                </div>
            </div>
        </div>

        <!-- Marketing Templates Tab -->
        <div class="tab-pane fade" id="marketing-templates" role="tabpanel">
            <div class="row g-4" id="marketing-templates-container">
                <div class="col-12 text-center py-5">
                    <i class="fas fa-bullhorn fa-3x text-muted mb-3"></i>
                    <h5 class="text-muted">No marketing templates yet</h5>
                    <p class="text-muted">Create templates for promotional messages, offers, and announcements</p>
                </div>
            </div>
        </div>

        <!-- OTP Templates Tab -->
        <div class="tab-pane fade" id="otp-templates" role="tabpanel">
            <div class="row g-4" id="otp-templates-container">
                <div class="col-12 text-center py-5">
                    <i class="fas fa-lock fa-3x text-muted mb-3"></i>
                    <h5 class="text-muted">No OTP templates yet</h5>
                    <p class="text-muted">Create templates for authentication codes and verification messages</p>
                </div>
            </div>
        </div>

        <!-- Custom Templates Tab -->
        <div class="tab-pane fade" id="custom-templates" role="tabpanel">
            <div class="row g-4" id="custom-templates-container">
                <div class="col-12 text-center py-5">
                    <i class="fas fa-edit fa-3x text-muted mb-3"></i>
                    <h5 class="text-muted">No custom templates yet</h5>
                    <p class="text-muted">Create custom templates for any type of message</p>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Create/Edit Template Modal -->
<div class="modal fade" id="templateModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="templateModalTitle">
                    <i class="fas fa-file-alt me-2"></i>Create Template
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="template-form">
                    <input type="hidden" id="template-id">
                    
                    <div class="mb-3">
                        <label for="template-name" class="form-label">Template Name *</label>
                        <input type="text" class="form-control" id="template-name" 
                               placeholder="e.g., Welcome Message" required>
                    </div>

                    <div class="mb-3">
                        <label for="template-category" class="form-label">Category *</label>
                        <select class="form-select" id="template-category" required>
                            <option value="">Select category...</option>
                            <option value="marketing">Marketing</option>
                            <option value="otp">OTP</option>
                            <option value="custom">Custom</option>
                        </select>
                    </div>

                    <div class="mb-3">
                        <label for="template-content" class="form-label">Message Content *</label>
                        <textarea class="form-control" id="template-content" rows="6" 
                                  placeholder="Enter your message template here..." required></textarea>
                        <small class="text-muted">
                            Use variables: {{name}}, {{code}}, {{date}}, {{amount}}, {{link}}
                        </small>
                    </div>

                    <div class="mb-3">
                        <label class="form-label">Variables Used</label>
                        <div id="template-variables" class="d-flex flex-wrap gap-2">
                            <span class="badge bg-secondary">None detected</span>
                        </div>
                    </div>

                    <div class="mb-3">
                        <label for="template-description" class="form-label">Description</label>
                        <textarea class="form-control" id="template-description" rows="2" 
                                  placeholder="Brief description of this template..."></textarea>
                    </div>

                    <div class="mb-3">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="template-active" checked>
                            <label class="form-check-label" for="template-active">
                                Active (available for use)
                            </label>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="submit" class="btn btn-primary" form="template-form">
                    <i class="fas fa-save me-2"></i>Save Template
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Preview Template Modal -->
<div class="modal fade" id="previewTemplateModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">
                    <i class="fas fa-eye me-2"></i>Template Preview
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div class="card">
                    <div class="card-body">
                        <h6 class="card-subtitle mb-2 text-muted" id="preview-template-name"></h6>
                        <p class="card-text" id="preview-template-content" style="white-space: pre-wrap;"></p>
                        <div class="mt-3">
                            <small class="text-muted">Category: <span id="preview-template-category"></span></small>
                        </div>
                    </div>
                </div>
                
                <div class="mt-3" id="preview-variables">
                    <h6>Test with Variables:</h6>
                    <form id="preview-variables-form">
                        <!-- Variables will be added dynamically -->
                    </form>
                    <div class="mt-3 p-3 bg-light rounded" id="preview-result">
                        <!-- Preview result will be shown here -->
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" id="use-template-btn">
                    <i class="fas fa-paper-plane me-2"></i>Use Template
                </button>
            </div>
        </div>
    </div>
</div>

<style>
    .template-card {
        transition: transform 0.2s, box-shadow 0.2s;
    }
    
    .template-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }
    
    .template-variables .badge {
        font-size: 0.85rem;
        padding: 0.5rem 0.75rem;
    }
    
    #template-content {
        font-family: 'Courier New', monospace;
        font-size: 0.95rem;
    }
    
    .nav-tabs .nav-link {
        color: #6c757d;
    }
    
    .nav-tabs .nav-link.active {
        color: #25D366;
        border-bottom-color: #25D366;
    }
    
    .template-card .badge {
        position: absolute;
        top: 10px;
        right: 10px;
    }
</style>

